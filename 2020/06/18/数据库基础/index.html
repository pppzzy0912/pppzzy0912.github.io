<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>数据库基础 | Ohhhhh</title><meta name="description" content="数据库基础"><meta name="keywords" content="学校课程,SQL"><meta name="author" content="PPPzzY"><meta name="copyright" content="PPPzzY"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="数据库基础"><meta name="twitter:description" content="数据库基础"><meta name="twitter:image" content="http://yoursite.com/img/post.jpg"><meta property="og:type" content="article"><meta property="og:title" content="数据库基础"><meta property="og:url" content="http://yoursite.com/2020/06/18/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/"><meta property="og:site_name" content="Ohhhhh"><meta property="og:description" content="数据库基础"><meta property="og:image" content="http://yoursite.com/img/post.jpg"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="http://yoursite.com/2020/06/18/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/"><link rel="next" title="JS基础" href="http://yoursite.com/2020/06/04/JS%E5%9F%BA%E7%A1%80/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  bookmark: {
    message_prev: 'Press',
    message_next: 'to bookmark this page'
  },
  runtime_unit: 'days',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.0"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">Articles</div><div class="length_num">9</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">Tags</div><div class="length_num">4</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">Categories</div><div class="length_num">5</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#一-绪论"><span class="toc-number">1.</span> <span class="toc-text">一 绪论</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#数据库系统概述"><span class="toc-number">1.1.</span> <span class="toc-text">数据库系统概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据模型！！！"><span class="toc-number">1.2.</span> <span class="toc-text">数据模型！！！</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#概念模型"><span class="toc-number">1.3.</span> <span class="toc-text">概念模型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#层次模型-Hierarchical-Model"><span class="toc-number">1.4.</span> <span class="toc-text">层次模型(Hierarchical Model)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#网状模型-Network-Model"><span class="toc-number">1.5.</span> <span class="toc-text">网状模型(Network Model)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#关系模型-Relational-Model"><span class="toc-number">1.6.</span> <span class="toc-text">关系模型(Relational Model)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据库系统结构"><span class="toc-number">1.7.</span> <span class="toc-text">数据库系统结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#数据库系统模式的概念"><span class="toc-number">1.7.1.</span> <span class="toc-text">数据库系统模式的概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#三级模式结构！！！"><span class="toc-number">1.7.2.</span> <span class="toc-text">三级模式结构！！！</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#二级映像功能与数据独立性！！！"><span class="toc-number">1.7.3.</span> <span class="toc-text">二级映像功能与数据独立性！！！</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#二-关系数据库"><span class="toc-number">2.</span> <span class="toc-text">二 关系数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#关系数据结构及形式化定义"><span class="toc-number">2.1.</span> <span class="toc-text">关系数据结构及形式化定义</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#关系操作！！！"><span class="toc-number">2.2.</span> <span class="toc-text">关系操作！！！</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#关系的完整性！！！"><span class="toc-number">2.3.</span> <span class="toc-text">关系的完整性！！！</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#三-关系数据库标准语言SQL！！！"><span class="toc-number">3.</span> <span class="toc-text">三 关系数据库标准语言SQL！！！</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL概述"><span class="toc-number">3.1.</span> <span class="toc-text">SQL概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据定义"><span class="toc-number">3.2.</span> <span class="toc-text">数据定义</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据查询！！！"><span class="toc-number">3.3.</span> <span class="toc-text">数据查询！！！</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据更新"><span class="toc-number">3.4.</span> <span class="toc-text">数据更新</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#视图！！！"><span class="toc-number">3.5.</span> <span class="toc-text">视图！！！</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#四-数据库安全性"><span class="toc-number">4.</span> <span class="toc-text">四 数据库安全性</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#概述"><span class="toc-number">4.1.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安全性控制！！！"><span class="toc-number">4.2.</span> <span class="toc-text">安全性控制！！！</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#视图机制"><span class="toc-number">4.3.</span> <span class="toc-text">视图机制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#审计"><span class="toc-number">4.4.</span> <span class="toc-text">审计</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据加密"><span class="toc-number">4.5.</span> <span class="toc-text">数据加密</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#统计数据库安全性"><span class="toc-number">4.6.</span> <span class="toc-text">统计数据库安全性</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#五-完整性！！！"><span class="toc-number">5.</span> <span class="toc-text">五 完整性！！！</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#实体-完整性！！！"><span class="toc-number">5.1.</span> <span class="toc-text">实体 完整性！！！</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参照-完整性！！！"><span class="toc-number">5.2.</span> <span class="toc-text">参照 完整性！！！</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#用户定义的-完整性！！！"><span class="toc-number">5.3.</span> <span class="toc-text">用户定义的 完整性！！！</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#六-关系数据理论"><span class="toc-number">6.</span> <span class="toc-text">六 关系数据理论</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#规范化"><span class="toc-number">6.1.</span> <span class="toc-text">规范化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#函数依赖！"><span class="toc-number">6.1.1.</span> <span class="toc-text">函数依赖！</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#范式！！！"><span class="toc-number">6.1.2.</span> <span class="toc-text">范式！！！</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#七-数据库设计！！！"><span class="toc-number">7.</span> <span class="toc-text">七 数据库设计！！！</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#基本步骤"><span class="toc-number">7.0.1.</span> <span class="toc-text">基本步骤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#需求分析"><span class="toc-number">7.0.2.</span> <span class="toc-text">需求分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#概念结构设计！！！"><span class="toc-number">7.0.3.</span> <span class="toc-text">概念结构设计！！！</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#逻辑结构设计"><span class="toc-number">7.0.4.</span> <span class="toc-text">逻辑结构设计</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#十-数据库恢复技术！！！"><span class="toc-number">8.</span> <span class="toc-text">十 数据库恢复技术！！！</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#事务的基本概念！！！"><span class="toc-number">8.1.</span> <span class="toc-text">事务的基本概念！！！</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#故障的种类"><span class="toc-number">8.2.</span> <span class="toc-text">故障的种类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#恢复的实现技术"><span class="toc-number">8.3.</span> <span class="toc-text">恢复的实现技术</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#恢复策略！！！"><span class="toc-number">8.4.</span> <span class="toc-text">恢复策略！！！</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#十一-并发控制"><span class="toc-number">9.</span> <span class="toc-text">十一 并发控制</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#并发控制概述"><span class="toc-number">9.1.</span> <span class="toc-text">并发控制概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#封锁"><span class="toc-number">9.2.</span> <span class="toc-text">封锁</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#封锁协议"><span class="toc-number">9.3.</span> <span class="toc-text">封锁协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#活锁和死锁！！！"><span class="toc-number">9.4.</span> <span class="toc-text">活锁和死锁！！！</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(/img/post.jpg)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">Ohhhhh</a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">数据库基础</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="Created 2020-06-18 12:56:40"><i class="fa fa-calendar" aria-hidden="true"></i> Created 2020-06-18</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="Updated 2020-06-18 19:27:46"><i class="fa fa-history" aria-hidden="true"></i> Updated 2020-06-18</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/DB/">DB</a></span></div><div class="meta-secondline"> <span class="post-meta-wordcount"><i class="post-meta__icon fa fa-file-word-o" aria-hidden="true"></i><span>Word count:</span><span class="word-count">8.8k</span><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-clock-o" aria-hidden="true"></i><span>Reading time: 27 min</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"><span class="post-meta__separator">|</span><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>Post View:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div id="article-container"><h1 id="一-绪论"><a href="#一-绪论" class="headerlink" title="一 绪论"></a>一 绪论</h1><h2 id="数据库系统概述"><a href="#数据库系统概述" class="headerlink" title="数据库系统概述"></a>数据库系统概述</h2><ol>
<li>数据(Data)    <ul>
<li>定义：描述事物的符号记录</li>
<li>数据与其语义是不可分的</li>
</ul>
</li>
<li>数据库(Database)<ul>
<li>定义：长期储存在计算机内、有组织的、可共享的大量数据的集合</li>
<li>基本特征：<ul>
<li>数据按一定的数据模型组织、描述和储存</li>
<li>具有较小的冗余度（redundancy）</li>
<li>较高的数据独立性（data independency）</li>
<li>易扩展性（scalability）</li>
<li>可为各种用户共享</li>
</ul>
</li>
<li>概括：永久储存、有组织、可共享</li>
</ul>
</li>
<li>数据库管理系统(DBMS)<ul>
<li>主要功能：数据定义功能（DDL）、数据组织存储和管理、数据操纵功能（DML）、数据库的事务管理和运行管理、数据库的建立和维护、其他功能</li>
<li>建立在OS上</li>
</ul>
</li>
<li>数据库系统(DBS)<ul>
<li>定义：由数据库、数据管理系统（及其应用开发工具）、应用程序和数据库管理员（DBA）组成的存储、管理、处理、和维护数据的系统</li>
<li>特点<ul>
<li>数据结构化：<strong>数据库最主要特征之一，与文件系统的本质区别</strong>；文件系统中数据存取单位是记录，粒度不能细到数据项</li>
<li>数据共享性高、冗余度低且易扩充：数据面向整个系统</li>
<li>数据独立性高：<strong>物理独立性</strong>（物理存储相互独立，应用程序只处理数据的逻辑结构）、<strong>逻辑独立性</strong>（逻辑结构相互独立）；由数据管理系统提供的二级映像功能来保证</li>
<li>数据由数据管理系统统一管理控制：数据的<strong>安全性</strong>保护、<strong>完整性</strong>检查、<strong>并发控制</strong>、数据库恢复</li>
</ul>
</li>
</ul>
</li>
<li>发展阶段：人工管理 –&gt; 文件系统 –&gt; 数据库系统</li>
</ol>
<h2 id="数据模型！！！"><a href="#数据模型！！！" class="headerlink" title="数据模型！！！"></a>数据模型！！！</h2><p>数据库系统的核心和基础。每个数据库中的数据都是按照某一种数据模型来组织、描述和存储的。</p>
<ol>
<li>定义：<strong>一种模型，是对现实世界数据特征的抽象。</strong></li>
<li>分类：<ul>
<li><strong>概念模型</strong><ul>
<li>用于信息世界的建模，现实世界到信息世界的第一层抽象</li>
</ul>
</li>
<li><strong>逻辑模型和物理模型</strong><ul>
<li>逻辑模型：网状模型、层次模型、关系模型、面向对象数据模型、对象关系数据模型、半结构化数据模型等</li>
<li>物理模型，面向计算机系统</li>
</ul>
</li>
</ul>
</li>
<li>组成三要素：<ul>
<li><strong>数据结构</strong>：描述数据库的组成对象，以及对象之间的联系；对系统<strong>静态</strong>特性的描述</li>
<li><strong>数据操作</strong>：对数据库中各种对象(型)的实例(值)允许执行的操作的集合，包括操作及有关的操作规则；对系统<strong>动态</strong>特性的描述</li>
<li><strong>数据的完整性约束条件</strong>：一组完整性规则</li>
</ul>
</li>
</ol>
<h2 id="概念模型"><a href="#概念模型" class="headerlink" title="概念模型"></a>概念模型</h2><ol>
<li>信息世界中的基本概念<ul>
<li>实体（Entity） ：客观存在并可相互区别的事物。可以是具体的人、事、物或抽象的概念。</li>
<li>属性（Attribute） ：实体所具有的某一特性</li>
<li>码（Key） ：唯一标识实体的属性集</li>
<li>实体型（Entity Type）：用实体名及其属性名集合来抽象和刻画同类实体</li>
<li>实体集（Entity Set）：同一类型实体的集合</li>
<li>联系（Relationship） ：实体内部的联系通常是指组成实体的各属性之间的联系，实体之间的联系通常是指不同实体集之间的联系<ul>
<li>一对一、一对多、多对多</li>
</ul>
</li>
</ul>
</li>
<li><strong>实体-联系方法（E-R方法）</strong>！<ul>
<li>实体型</li>
<li>属性</li>
<li>联系：联系本身、联系的属性</li>
</ul>
</li>
</ol>
<h2 id="层次模型-Hierarchical-Model"><a href="#层次模型-Hierarchical-Model" class="headerlink" title="层次模型(Hierarchical Model)"></a>层次模型(Hierarchical Model)</h2><ol>
<li>满足条件：<ol>
<li>有且只有一个结点没有双亲结点，这个结点称为根结点</li>
<li>根以外的其它结点有且只有一个双亲结点</li>
</ol>
</li>
<li>完整性约束条件<ul>
<li>无相应的双亲结点值就不能插入子女结点值</li>
<li>如果删除双亲结点值，则相应的子女结点值也被同时删除</li>
<li>更新操作时，应更新所有相应记录，以保证数据的一致性</li>
</ul>
</li>
<li>存储结构<ol>
<li>邻接法<ul>
<li>按照层次树前序遍历的顺序把所有记录值依次邻接存放，即通过物理空间的位置相邻来实现层次顺序</li>
</ul>
</li>
<li>链接法<ul>
<li>用指引来反映数据之间的层次联系</li>
<li>子女－兄弟链接法：每个记录设两类指针，分别指向最左边的子女（每个记录型对应一个）和最近的兄弟</li>
<li>层次序列链接法：按树的前序穿越顺序链接各记录值</li>
</ul>
</li>
</ol>
</li>
<li>优缺点</li>
</ol>
<h2 id="网状模型-Network-Model"><a href="#网状模型-Network-Model" class="headerlink" title="网状模型(Network Model)"></a>网状模型(Network Model)</h2><ol>
<li>满足条件<ol>
<li>允许一个以上的结点无双亲；</li>
<li>一个结点可以有多于一个的双亲。</li>
</ol>
</li>
<li>网状模型与层次模型的区别<ul>
<li>网状模型允许多个结点没有双亲结点，结点有多个双亲结点</li>
<li>网状模型允许两个结点之间有多种联系（复合联系）</li>
<li>网状模型可以更直接地去描述现实世界</li>
<li>层次模型实际上是网状模型的一个特例</li>
</ul>
</li>
<li>关键：实现记录之间的联系</li>
<li>优缺点<ul>
<li>优点：更为直接描述；良好性能，存取效率高</li>
<li>缺点：结构比较复杂；DDL、DML比较复杂，要求用户掌握数据库结构和存取路径</li>
</ul>
</li>
</ol>
<h2 id="关系模型-Relational-Model"><a href="#关系模型-Relational-Model" class="headerlink" title="关系模型(Relational Model)"></a>关系模型(Relational Model)</h2><ol>
<li><p>关系结构</p>
<p>​    在用户观点下，关系模型中数据的逻辑结构是一张二维表，它由行和列组成</p>
<ul>
<li>关系（Relation）：一个关系对应通常说的一张表</li>
<li>元组（Tuple）：表中的一行即为一个元组<ul>
<li>同一关系模型的任两个元组值不能全同</li>
</ul>
</li>
<li>属性（Attribute）：表中的一列即为一个属性，给每一个属性起一个名称即属性名</li>
<li>主码（Key）：表中的某个属性组，它可以唯一确定一个元组<ul>
<li>一个关键字可由一个或多个其值能唯一标识该关系模式中任何元组的属性组成</li>
</ul>
</li>
<li>域（Domain）：属性的取值范围</li>
<li>分量：元组中的一个属性值</li>
<li>关系模式：对关系的描述</li>
</ul>
</li>
<li><p>规范条件</p>
<ul>
<li>关系的每一个分量必须是一个不可分的数据项，不允许表中还有表</li>
</ul>
</li>
<li><p>完整性约束条件 </p>
<ul>
<li>实体完整性</li>
<li>参照完整性</li>
<li>用户定义的完整性</li>
</ul>
</li>
<li><p>存储结构</p>
<ul>
<li>实体及实体间的联系都用表来表示，表以文件形式存储</li>
</ul>
</li>
</ol>
<h2 id="数据库系统结构"><a href="#数据库系统结构" class="headerlink" title="数据库系统结构"></a>数据库系统结构</h2><h3 id="数据库系统模式的概念"><a href="#数据库系统模式的概念" class="headerlink" title="数据库系统模式的概念"></a>数据库系统模式的概念</h3><ol>
<li>“型” 和“值” 的概念<ul>
<li>型（Type）：对某一类数据的结构和属性的说明</li>
<li>值（Value）：是型的一个具体赋值</li>
</ul>
</li>
<li>模式（Schema）：数据库逻辑结构和特征的描述，是型的描述。反映的是数据的结构及其联系，模式是相对稳定的。</li>
<li>实例（Instance）：模式的一个具体值。反映数据库某一时刻的状态。同一个模式可以有很多实例，实例随数据库中的数据的更新而变动。</li>
</ol>
<h3 id="三级模式结构！！！"><a href="#三级模式结构！！！" class="headerlink" title="三级模式结构！！！"></a>三级模式结构！！！</h3><ul>
<li><strong>模式（Schema）</strong>（也称逻辑模式）<ul>
<li>数据库中全体数据的逻辑结构和特征的描述，所有用户的公共数据视图，综合了所有用户的需求</li>
<li>一个数据库只有一个模式</li>
<li>地位：是数据库系统模式结构的中间层</li>
<li>定义：数据的逻辑结构（数据项的名字、类型、取值范围等）| 数据之间的联系| 数据有关的安全性、完整性要求</li>
</ul>
</li>
<li><strong>外模式（External Schema）</strong>（也称子模式或用户模式）<ul>
<li>数据库用户（包括应用程序员和最终用户）使用的局部数据的逻辑结构和特征的描述，数据库用户的数据视图，是与某一应用有关的数据的逻辑表示</li>
<li>地位：介于模式与应用之间</li>
<li>关系：模式-&gt;外模式||外模式-&gt;应用：一对多</li>
<li>每个用户只能看见和访问所对应的外模式中的数据</li>
</ul>
</li>
<li><strong>内模式（Internal Schema）</strong>（也称存储模式）<ul>
<li>是数据物理结构和存储方式的描述</li>
<li>是数据在数据库内部的表示方式</li>
<li>一个数据库只有一个内模式</li>
</ul>
</li>
</ul>
<h3 id="二级映像功能与数据独立性！！！"><a href="#二级映像功能与数据独立性！！！" class="headerlink" title="二级映像功能与数据独立性！！！"></a>二级映像功能与数据独立性！！！</h3><p>三级模式是对数据的三个抽象级别，二级映象在DBMS内部实现这三个抽象层次的联系和转换。</p>
<ul>
<li><strong>外模式/模式映像</strong>：<ul>
<li>模式：描述的是数据的全局逻辑结构；外模式：描述的是数据的局部逻辑结构 </li>
<li>同一个模式可以有任意多个外模式；每一个外模式，数据库系统都有一个外模式／模式映像，定义外模式与模式之间的对应关系</li>
<li>映象定义通常包含在各自外模式的描述中</li>
<li><strong>保证数据的逻辑独立性</strong>：当模式改变时，数据库管理员修改有关的外模式／模式映象，使外模式保持不变；应用程序是依据数据的外模式编写的，从而应用程序不必修改</li>
</ul>
</li>
<li><strong>模式/内模式映像</strong>：<ul>
<li>定义了数据全局逻辑结构与存储结构之间的对应关系</li>
<li>数据库中模式／内模式映象是唯一的</li>
<li>该映象定义通常包含在模式描述中</li>
<li><strong>保证数据的物理独立性</strong>：当数据库的存储结构改变了（例如选用了另一种存储结构），数据库管理员修改模式／内模式映象，使模式保持不变；应用程序不受影响</li>
</ul>
</li>
</ul>
<p>数据与程序之间的独立性，使得数据的定义和描述可以从应用程序中分离出去 </p>
<h1 id="二-关系数据库"><a href="#二-关系数据库" class="headerlink" title="二 关系数据库"></a>二 关系数据库</h1><h2 id="关系数据结构及形式化定义"><a href="#关系数据结构及形式化定义" class="headerlink" title="关系数据结构及形式化定义"></a>关系数据结构及形式化定义</h2><ul>
<li>关系<ul>
<li>单一的数据结构；现实世界的实体以及实体间的各种联系均用关系来表示</li>
<li>域：一组具有相同数据类型的值的集合</li>
<li>笛卡尔积：域上的一种集合运算。n元组、分量、基数</li>
<li>关系：<ul>
<li>目或度（n目关系必有n个属性）</li>
<li>候选码：唯一地标识一个元组</li>
<li>主码、主属性/非主属性、全码</li>
</ul>
</li>
<li>三类关系：基本关系、查询表、视图表</li>
<li>基本关系的性质：<ul>
<li>列是同质的，值来自同一个域；不同的列可以出自同一个域</li>
<li>列/行的次序可任意交换</li>
<li>任意两个元组的候选码不能取相同的值</li>
<li>分量必须取原子值</li>
</ul>
</li>
</ul>
</li>
<li>关系模式<ul>
<li>关系是关系模式在某一时刻的状态或内容；关系模式是型，关系是值，是关系模式的实例</li>
</ul>
</li>
<li>关系数据库</li>
</ul>
<h2 id="关系操作！！！"><a href="#关系操作！！！" class="headerlink" title="关系操作！！！"></a>关系操作！！！</h2><ul>
<li>常用的关系操作<ul>
<li><strong>查询</strong>：选择、投影、连接、除并交差</li>
<li>更新：<strong>插入</strong>、<strong>删除</strong>、<strong>修改</strong></li>
<li>选择、投影、并、差、笛卡尔积是5种基本操作</li>
</ul>
</li>
<li>特点<ul>
<li>集合操作方式：操作的对象和结果都是集合，一次一集合的方式</li>
</ul>
</li>
</ul>
<h2 id="关系的完整性！！！"><a href="#关系的完整性！！！" class="headerlink" title="关系的完整性！！！"></a>关系的完整性！！！</h2><ul>
<li><strong>实体完整性</strong><ul>
<li>若属性<em>A</em>是基本关系<em>R</em>的主属性，则属性<em>A</em>不能取空值</li>
<li>实体完整性规则是针对基本关系而言的。一个基本表通常对应现 实世界的一个实体集</li>
<li>关系模型中<strong>以主码作为唯一性标识</strong></li>
</ul>
</li>
<li><strong>参照完整性</strong><ul>
<li>关系间的引用</li>
<li>外码</li>
<li>参照完整性规则：<strong>或取空值或等于S中某个元组的主码值</strong></li>
</ul>
</li>
<li><strong>用户定义的完整性</strong><ul>
<li>针对某一具体关系数据库的约束条件，它反映某一具体应用所涉及的数据必须满足的语义要求</li>
</ul>
</li>
</ul>
<h1 id="三-关系数据库标准语言SQL！！！"><a href="#三-关系数据库标准语言SQL！！！" class="headerlink" title="三 关系数据库标准语言SQL！！！"></a>三 关系数据库标准语言SQL！！！</h1><h2 id="SQL概述"><a href="#SQL概述" class="headerlink" title="SQL概述"></a>SQL概述</h2><p>SQL集<strong>数据查询</strong>、<strong>数据操纵</strong>、<strong>数据定义</strong>、<strong>数据控制</strong>功能于一体</p>
<ul>
<li>综合统一：DDL+DML+DCL</li>
<li>高度非过程化</li>
<li>面向集合的操作方式</li>
<li>以同一种语法结构提供多种使用方式</li>
<li>语言简洁，易学易用</li>
</ul>
<p>用户可用SQL对基本表和视图进行查询或其他操作，基本表和视图一样都是关系</p>
<ul>
<li><strong>基本表是本身独立存在的表</strong>。一个关系对应一个基本表；一个或多个基本表对应一个存储文件；一个表可带若干索引</li>
<li>存储文件的逻辑结构组成了关系数据库的内模式</li>
<li><strong>视图是从一个或几个基本表导出的表。它本身不独立存储在数据库中</strong>；即数据库只存放视图的定义；视图是一个虚表；用户可以在视图上再定义视图</li>
</ul>
<h2 id="数据定义"><a href="#数据定义" class="headerlink" title="数据定义"></a>数据定义</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*创建*/</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">SCHEMA</span>/<span class="keyword">TABLE</span>/<span class="keyword">VIEW</span>/<span class="keyword">INDEX</span>;</span><br><span class="line"><span class="comment">/*删除*/</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">SCHEMA</span>/<span class="keyword">TABLE</span>/<span class="keyword">VIEW</span>/<span class="keyword">INDEX</span>;</span><br><span class="line"><span class="comment">/*修改*/</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span>/<span class="keyword">INDEX</span>;</span><br></pre></td></tr></table></figure>

<p>定义模式实际上定义了一个命名空间。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">SCHEMA</span> &lt;模式名&gt; AUTHORIZATION &lt;用户名&gt; [&lt;表定义子句&gt;|&lt;视图定义子句&gt;|&lt;授权定义子句&gt;];</span><br><span class="line"><span class="comment">/*CASCADE（级联）删除模式时也删除该模式中所有的数据库对象*/</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">SCHEMA</span> &lt;模式名&gt; &lt;<span class="keyword">CASCADE</span>|RESTRICT&gt;;</span><br></pre></td></tr></table></figure>

<p>数据类型：</p>
<ul>
<li>CHAR(n) | VARCHAR(n)</li>
<li>INT | SMALLINT</li>
<li>NUMERIC(p,d)：定点数，由p位数字（不包括符号、小数点）组成，小数后面有d位数字</li>
<li>REAL：取决于机器精度的浮点数</li>
<li>DOUBLE PRECISION</li>
<li>FLOAT(n)</li>
<li>DATE | TIME</li>
<li>CLOB | BLOB</li>
</ul>
<p>修改基本表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> &lt;表名&gt;</span><br><span class="line">	[<span class="keyword">ADD</span> [<span class="keyword">COLUMN</span>] &lt;新列名&gt; &lt;数据类型&gt; []]</span><br><span class="line">	[<span class="keyword">ADD</span> &lt;表级完整性约束&gt;]</span><br><span class="line">	[<span class="keyword">DROP</span> [<span class="keyword">COLUMN</span>] &lt;列名&gt; [<span class="keyword">CASCADE</span>|RESTRICT]]</span><br><span class="line">	[<span class="keyword">DROP</span> <span class="keyword">CONSTRAINT</span> &lt;完整性约束名&gt; [<span class="keyword">CASCADE</span>|RESTRICT]]</span><br><span class="line">	[<span class="keyword">ALTER</span> <span class="keyword">COLUMN</span> &lt;列名&gt; &lt;数据类型&gt;]</span><br></pre></td></tr></table></figure>

<p>建立索引的目的：加快查询速度。DBMS一般会自动建立以下列上的索引<br><code>PRIMARY  KEY</code>，<code>UNIQUE</code>。</p>
<p>RDBMS中索引一般采用B+树（动态平衡）、HASH索引（查找速度快）来实现</p>
<p>索引是关系数据库的内部实现技术，属于内模式的范畴</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> [<span class="keyword">UNIQUE</span>] [CLUSTER] <span class="keyword">INDEX</span> &lt;索引名&gt; </span><br><span class="line">	<span class="keyword">ON</span> &lt;表名&gt; ( &lt;列名&gt;[&lt;次序&gt;][,&lt;列名&gt;[&lt;次序&gt;]]… );</span><br></pre></td></tr></table></figure>

<p><strong>数据字典！</strong></p>
<p>数据字典是关系数据库管理系统内部的一组系统表，它记录了数据库中所有的定义信息，包括关系模式定义、视图定义、索引定义、完整性约束定义、各类用户对数据库的操作权限、统计信息等。</p>
<h2 id="数据查询！！！"><a href="#数据查询！！！" class="headerlink" title="数据查询！！！"></a>数据查询！！！</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> [<span class="keyword">ALL</span>|<span class="keyword">DISTINCT</span>] &lt;目标列表达式&gt; [，&lt;目标列表达式&gt;] …</span><br><span class="line"><span class="keyword">FROM</span> &lt;表名或视图名&gt;[， &lt;表名或视图名&gt; ] … </span><br><span class="line">	[ <span class="keyword">WHERE</span> &lt;条件表达式&gt; ]</span><br><span class="line">	[ <span class="keyword">GROUP</span> <span class="keyword">BY</span> &lt;列名<span class="number">1</span>&gt; [ <span class="keyword">HAVING</span> &lt;条件表达式&gt; ] ]</span><br><span class="line">	[ <span class="keyword">ORDER</span> <span class="keyword">BY</span> &lt;列名<span class="number">2</span>&gt; [ <span class="keyword">ASC</span>|<span class="keyword">DESC</span> ] ];</span><br></pre></td></tr></table></figure>

<ul>
<li><p>单表查询</p>
<ul>
<li>选择表中的若干列<ul>
<li><code>SELECT * FROM Student;</code></li>
<li><code>SELECT Sname NAME, &#39;Year of Birth:&#39; BIRTH, 2000-Sage BIRTHDAY, LOWER(Sdept) DEPARTMENT FROM Student；</code></li>
</ul>
</li>
<li>选择表中的若干元组<ul>
<li>去掉表中重复的行：<code>SELECT DISTINCT Sno FROM SC;</code></li>
<li><code>BETWEEN...AND...</code>，<code>NOT BETWEEN...AND...</code></li>
<li>IN &lt;值表&gt;,  NOT IN &lt;值表&gt; </li>
<li>[NOT] LIKE  ‘&lt;匹配串&gt;’  [ESCAPE ‘ &lt;换码字符&gt;’]</li>
<li>AND，OR，NOT</li>
</ul>
</li>
<li>ORDER BY子句：<code>ASC</code>升序；<code>DESC</code>降序；缺省值为升序</li>
<li>聚集函数<ul>
<li><code>COUNT</code>、<code>SUM</code>、<code>AVG</code>、<code>MAX</code>、<code>MIN</code></li>
<li>WHERE子句中不能用聚集函数作为条件表达式，只能用于SELECT子句和GROUP BY中的 HAVING子句</li>
</ul>
</li>
<li>GROUP BY子句<ul>
<li>将查询结果按某一列或多列的值分组，值相等为一组</li>
<li>细化聚集函数的作用对象</li>
<li><code>SELECT Sno FROM SC GROUP BY Sno HAVING COUNT(*)&gt;3</code></li>
<li>WHERE子句作用于基本表或视图，HAVING短语作用于组</li>
</ul>
</li>
</ul>
</li>
<li><p>连接查询</p>
<ul>
<li>等值/非等值连接：嵌套循环连接算法</li>
<li>自然连接：把目标列中重复的属性去掉</li>
<li>自身连接：必须使用别名前缀；例如先修课</li>
<li>外连接：LEFT/RIGHT OUT JOIN</li>
</ul>
</li>
<li><p>嵌套查询</p>
<ul>
<li>子查询不能使用ORDER BY子句</li>
<li>IN、比较运算符、ANY(SOME)  ALL、EXISTS</li>
<li>用EXISTS/NOT EXISTS实现全称量词(难点)</li>
<li>用EXISTS/NOT EXISTS实现逻辑蕴函(难点)</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*查询选修了全部课程的学生姓名。*/</span></span><br><span class="line"><span class="keyword">SELECT</span> Sname <span class="keyword">FROM</span> Student</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span></span><br><span class="line">     (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> Course</span><br><span class="line">       <span class="keyword">WHERE</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span></span><br><span class="line">           (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> SC</span><br><span class="line">            <span class="keyword">WHERE</span> Sno= Student.Sno <span class="keyword">AND</span> Cno= Course.Cno</span><br><span class="line">            )</span><br><span class="line">      );</span><br><span class="line"><span class="comment">/*查询至少选修了学生200215122选修的全部课程的学生号码。*/</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> Sno <span class="keyword">FROM</span> SC SCX</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span></span><br><span class="line">	 (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> SC SCY</span><br><span class="line">      <span class="keyword">WHERE</span> SCY.Sno=<span class="string">'200215122'</span> <span class="keyword">AND</span> </span><br><span class="line">      <span class="keyword">NOT</span> <span class="keyword">EXISTS</span></span><br><span class="line">     	   (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> SC SCZ</span><br><span class="line">            <span class="keyword">WHERE</span> SCZ.Sno=SCX.Sno <span class="keyword">AND</span> SCZ.Cno=SCY.Cno</span><br><span class="line">           )</span><br><span class="line">     );</span><br></pre></td></tr></table></figure>
</li>
<li><p>集合查询</p>
<ul>
<li><p>并：UNION</p>
</li>
<li><p>交：INTERSECT</p>
</li>
<li><p>差：EXCEPT</p>
</li>
</ul>
</li>
</ul>
<h2 id="数据更新"><a href="#数据更新" class="headerlink" title="数据更新"></a>数据更新</h2><ul>
<li>插入数据</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> &lt;表名&gt; [(&lt;属性列<span class="number">1</span>&gt;[，&lt;属性列<span class="number">2</span> &gt;…)]</span><br><span class="line">            <span class="keyword">VALUES</span> (&lt;常量<span class="number">1</span>&gt; [，&lt;常量<span class="number">2</span>&gt;]…);</span><br><span class="line">                   </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> &lt;表名&gt; [(&lt;属性列<span class="number">1</span>&gt;[，&lt;属性列<span class="number">2</span> &gt;…)] 子查询;</span><br></pre></td></tr></table></figure>

<ul>
<li>修改数据</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> &lt;表名&gt;</span><br><span class="line"><span class="keyword">SET</span> &lt;列名&gt;=&lt;表达式&gt; [,&lt;列名&gt;=&lt;表达式&gt;] … [<span class="keyword">WHERE</span> &lt;条件&gt;];</span><br></pre></td></tr></table></figure>

<ul>
<li>删除数据</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> &lt;表名&gt; [<span class="keyword">WHERE</span> &lt;条件&gt;];</span><br></pre></td></tr></table></figure>

<h2 id="视图！！！"><a href="#视图！！！" class="headerlink" title="视图！！！"></a>视图！！！</h2><p>视图是用户查看数据库中数据的一种方式。<br>视图是一种逻辑对象，不占用物理空间，其作用相当于查询，所包含的列和行的数据只是来源于视图所查询的表。</p>
<ul>
<li><strong>视图和基本表的区别！！！</strong><ul>
<li><strong>基本表中的数据是物理存在的，并存储在存储介质上，而视图本身没有存储任何实际数据，只是一种逻辑对象，它所有的数据通过引用基本表反映出来。</strong></li>
<li><strong>视图确定的行和列可以是一个基本表中行的子集或列的子集；可以是多个基本表的联接；可以是由基本表进行运算汇总的结果；可以是另外一个视图的子集；也可以是视图与基本表之间的组合。</strong></li>
</ul>
</li>
<li>视图的特点<ul>
<li>虚表，是从一个或几个基本表（或视图）导出的表</li>
<li>只存放视图的定义，不存放视图对应的数据</li>
<li>基表中的数据发生变化，从视图中查询出的数据也随之改变</li>
</ul>
</li>
<li><strong>视图的作用！</strong><ul>
<li>简化用户的操作</li>
<li>使用户能以多种角度看待同一数据</li>
<li>对重构数据库提供了一定程度的逻辑独立性</li>
<li>能够对机密数据提供安全保护</li>
<li>适当的利用视图可以更清晰的表达查询</li>
</ul>
</li>
<li>基本表的行列子集视图一般是可更新的；若视图来自聚集函数、表达式，则不可更新</li>
</ul>
<p>定义视图</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> &lt;视图名&gt; [(&lt;列名&gt; [，&lt;列名&gt;]…)]</span><br><span class="line">	<span class="keyword">AS</span> &lt;子查询&gt;</span><br><span class="line">[<span class="keyword">WITH</span> <span class="keyword">CHECK</span> <span class="keyword">OPTION</span>];</span><br><span class="line"><span class="comment">/**/</span></span><br></pre></td></tr></table></figure>



<h1 id="四-数据库安全性"><a href="#四-数据库安全性" class="headerlink" title="四 数据库安全性"></a>四 数据库安全性</h1><p>保护数据库以防止不合法的使用所造成的数据泄露、更改或破坏。</p>
<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><table>
<thead>
<tr>
<th align="center">安全级别</th>
<th align="left">定义</th>
</tr>
</thead>
<tbody><tr>
<td align="center">A1</td>
<td align="left">验证设计（Verified Design）</td>
</tr>
<tr>
<td align="center">B3</td>
<td align="left">安全域（Security Domains）</td>
</tr>
<tr>
<td align="center">B2</td>
<td align="left">结构化保护（Structural Protection）</td>
</tr>
<tr>
<td align="center">B1</td>
<td align="left">标记安全保护（Labeled Security Protection）</td>
</tr>
<tr>
<td align="center">C2</td>
<td align="left">受控的存取保护（Controlled Access Protection）</td>
</tr>
<tr>
<td align="center">C1</td>
<td align="left">自主安全保护（Discretionary Security Protection）</td>
</tr>
<tr>
<td align="center">D</td>
<td align="left">最小保护（Minimal Protection）</td>
</tr>
</tbody></table>
<p>C1：能实现对用户和数据的分离，进行<strong>自主存取控制（DAC）</strong>，保护或限制用户权限的传播。</p>
<p>B1：对标记的主体和客体实施<strong>强制存取控制（MAC）</strong>以及审计等安全机制。</p>
<h2 id="安全性控制！！！"><a href="#安全性控制！！！" class="headerlink" title="安全性控制！！！"></a>安全性控制！！！</h2><ul>
<li><p>用户标识与鉴别（Identification &amp;  Authentication）</p>
<ul>
<li>系统提供的最外层安全保护措施</li>
<li>用户标识：用户名、用户标识号</li>
<li>常用鉴别方法</li>
</ul>
</li>
<li><p>存取控制</p>
<ul>
<li>组成：定义用户权限、合法权限检查</li>
<li>用户权限定义和合法权检查机制一起组成了  DBMS的安全子系统</li>
</ul>
</li>
<li><p><strong>自主存取控制方法！！！</strong></p>
<ul>
<li>通过 SQL 的 <code>GRANT</code> 语句和 <code>REVOKE</code> 语句实现</li>
<li>用户权限组成：数据对象、操作类型</li>
<li>定义存取权限称为授权 </li>
</ul>
</li>
<li><p><strong>强制存取控制方法！！！</strong></p>
<ul>
<li>保证更高程度的安全性；用户能不能直接感知或进行控制</li>
<li>主体是系统中的活动实体（DBMS所管理的实际用户、代表用户的各进程）；客体是系统中的被动实体，受主体操纵（文件、基表、索引、视图）</li>
<li>敏感度标记（Label）：<ul>
<li>绝密（Top Secret）机密（Secret）可信（Confidential）公开（Public）</li>
<li>主体的敏感度标记称为许可证级别（Clearance Level）；客体的敏感度标记称为密级（Classification Level）。</li>
</ul>
</li>
<li><strong>强制存取控制规则</strong><ul>
<li>仅当主体的许可证级别 ≧ 客体的密级时，该主体才能<strong>读取</strong>相应的客体</li>
<li>仅当主体的许可证级别 ≦ 客体的密级时，该主体才能<strong>写</strong>相应的客体</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>授权与回收！！！</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*将对指定操作对象的指定操作权限授予指定的用户 */</span></span><br><span class="line"><span class="keyword">GRANT</span> &lt;权限&gt; [,&lt;权限&gt;]...</span><br><span class="line">	[<span class="keyword">ON</span> &lt;对象类型&gt; &lt;对象名&gt;]</span><br><span class="line">	<span class="keyword">TO</span> &lt;用户&gt; [,&lt;用户&gt;]...</span><br><span class="line">[<span class="keyword">WITH</span> <span class="keyword">GRANT</span> <span class="keyword">OPTION</span>];  <span class="comment">/*指定则获取该权限用户可再授予*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*把对Student表和Course表的全部权限授予用户U2和U3*/</span></span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">ALL</span> PRIVILIGES </span><br><span class="line">      <span class="keyword">ON</span> <span class="keyword">TABLE</span> Student, Course </span><br><span class="line">      <span class="keyword">TO</span> U2, U3;</span><br><span class="line"><span class="comment">/*把对表SC的INSERT权限授予U5用户并允许他再将此权限授予其他用户*/</span></span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">INSERT</span> </span><br><span class="line">    <span class="keyword">ON</span> <span class="keyword">TABLE</span> SC </span><br><span class="line">    <span class="keyword">TO</span> U5</span><br><span class="line"><span class="keyword">WITH</span> <span class="keyword">GRANT</span> <span class="keyword">OPTION</span>;</span><br><span class="line"><span class="comment">/*把对表SC的查询权限授予所有用户*/</span></span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">SELECT</span> <span class="keyword">ON</span> <span class="keyword">TABLE</span> SC <span class="keyword">TO</span> <span class="keyword">PUBLIC</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">REVOKE</span> &lt;权限&gt; [,&lt;权限&gt;]...</span><br><span class="line">	[<span class="keyword">ON</span> &lt;对象类型&gt; &lt;对象名&gt;]</span><br><span class="line">	<span class="keyword">FROM</span> &lt;用户&gt; [,&lt;用户&gt;]...;</span><br><span class="line">	</span><br><span class="line"><span class="comment">/*把用户U5对SC表的INSERT权限收回*/</span></span><br><span class="line"><span class="keyword">REVOKE</span> <span class="keyword">INSERT</span></span><br><span class="line">	<span class="keyword">ON</span> <span class="keyword">TABLE</span> SC</span><br><span class="line">	<span class="keyword">FROM</span> U5 <span class="keyword">CASCADE</span>; </span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> *将用户U5的INSERT权限收回的时候必须级联（CASCADE）收回,</span></span><br><span class="line"><span class="comment"> *系统只收回直接或间接从U5处获得的权限 </span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="视图机制"><a href="#视图机制" class="headerlink" title="视图机制"></a>视图机制</h2><p>把要保密的数据对无权存取这些数据的用户隐藏起来，对数据提供一定程度的安全保护 。</p>
<h2 id="审计"><a href="#审计" class="headerlink" title="审计"></a>审计</h2><ul>
<li>审计事件</li>
<li>审计功能</li>
<li>AUDIT 和 NOT AUDIT 语句</li>
</ul>
<h2 id="数据加密"><a href="#数据加密" class="headerlink" title="数据加密"></a>数据加密</h2><ul>
<li>存储加密</li>
<li>传输加密</li>
</ul>
<h2 id="统计数据库安全性"><a href="#统计数据库安全性" class="headerlink" title="统计数据库安全性"></a>统计数据库安全性</h2><h1 id="五-完整性！！！"><a href="#五-完整性！！！" class="headerlink" title="五 完整性！！！"></a>五 完整性！！！</h1><ul>
<li>数据库的完整性：指数据的正确性和相容性</li>
<li>完整性和安全性区别：<ul>
<li>完整性：防止数据库中存在不符合语义的数据</li>
<li>安全性：保护数据库防止恶意的破坏和非法的存取</li>
</ul>
</li>
<li>维护数据库完整性，DBMS：<ul>
<li>提供定义完整性约束条件的机制</li>
<li>提供完整性检查的方法</li>
<li>违约处理</li>
</ul>
</li>
</ul>
<h2 id="实体-完整性！！！"><a href="#实体-完整性！！！" class="headerlink" title="实体 完整性！！！"></a>实体 完整性！！！</h2><ul>
<li>关系模型的实体完整性在CREATE TABLE 中用 <code>PRIMARY KEY</code> 定义</li>
<li>列级约束条件/表级约束条件</li>
<li>检查<ul>
<li>主码值是否唯一（方法：全表扫描）</li>
<li>主码的各个属性是否为空</li>
</ul>
</li>
</ul>
<h2 id="参照-完整性！！！"><a href="#参照-完整性！！！" class="headerlink" title="参照 完整性！！！"></a>参照 完整性！！！</h2><ul>
<li><code>FOREIGN KEY</code>定义哪些列为外码；<code>REFERENCES</code>指明这些外码参照哪些表的主码</li>
</ul>
<table>
<thead>
<tr>
<th align="left">被参照表（例如Student）</th>
<th align="left">参照表（例如SC）</th>
<th>违约处理</th>
</tr>
</thead>
<tbody><tr>
<td align="left">可能破坏参照完整性</td>
<td align="left">&lt;–插入元组</td>
<td>拒绝</td>
</tr>
<tr>
<td align="left">可能破坏参照完整性</td>
<td align="left">&lt;–修改外码值</td>
<td>拒绝</td>
</tr>
<tr>
<td align="left">删除元组  –&gt;</td>
<td align="left">可能破坏参照完整性</td>
<td>拒绝/级连删除/设置为空值</td>
</tr>
<tr>
<td align="left">修改主码值  –&gt;</td>
<td align="left">可能破坏参照完整性</td>
<td>拒绝/级连修改/设置为空值</td>
</tr>
</tbody></table>
<ul>
<li>参照完整性违约处理<ul>
<li>拒绝（NO ACTION）执行：默认策略</li>
<li>级联（CASCADE）操作</li>
<li>设置为空值（SET-NULL）：对于参照完整性，除了应该定义外码，还应定义外码列是否允许空值</li>
</ul>
</li>
</ul>
<h2 id="用户定义的-完整性！！！"><a href="#用户定义的-完整性！！！" class="headerlink" title="用户定义的 完整性！！！"></a>用户定义的 完整性！！！</h2><ul>
<li>针对某一具体应用的数据必须满足的语义要求</li>
<li>属性上的约束条件<ul>
<li>定义：<code>NOT NULL</code>、<code>UNIQUE</code>、<code>CHECK</code></li>
<li>检查和违约处理：插入元组或修改属性的值时，RDBMS检查属性上的约束条件是否被满足，不满足则操作被拒绝执行 </li>
</ul>
</li>
<li>元组上的约束条件<ul>
<li>定义：可以用<code>CHECK</code>短语定义元组上的约束条件，即元组级的限制（可以设置不同属性之间的取值的相互约束条件 ）</li>
<li>检查和违约处理：同上</li>
</ul>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*CONSTRAINT约束*/</span></span><br><span class="line">CONSTRAINT &lt;完整性约束条件名&gt; [PRIMARY 短语 | FOREIGN 短语 | CHECK 短语]</span><br><span class="line"><span class="comment">/*ALTER TABLE 修改*/</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> St <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> C1 <span class="keyword">CHECK</span> ...;</span><br></pre></td></tr></table></figure>



<h1 id="六-关系数据理论"><a href="#六-关系数据理论" class="headerlink" title="六 关系数据理论"></a>六 关系数据理论</h1><ul>
<li>数据依赖：<ul>
<li>一个关系内部属性与属性之间的一种约束关系</li>
<li>函数依赖（FD）/多值依赖（MVD）/其他</li>
</ul>
</li>
</ul>
<h2 id="规范化"><a href="#规范化" class="headerlink" title="规范化"></a>规范化</h2><p>用来改造关系模式，通过分解关系模式来消除其中不合适的数据依赖，以解决插入异常、删除异常、更新异常和数据冗余问题。</p>
<h3 id="函数依赖！"><a href="#函数依赖！" class="headerlink" title="函数依赖！"></a><strong>函数依赖！</strong></h3><ul>
<li>定义</li>
<li>非平凡的函数依赖 / 平凡的函数依赖</li>
<li>完全函数依赖(F) / 部分函数依赖(P)</li>
<li>传递函数依赖 （ / 直接依赖）</li>
</ul>
<h3 id="范式！！！"><a href="#范式！！！" class="headerlink" title="范式！！！"></a><strong>范式！！！</strong></h3><ul>
<li><p>规范化</p>
<ul>
<li>一个低一级范式的关系模式，通过模式分解可以转换为若干个高一级范式的关系模式的集合</li>
</ul>
</li>
<li><p>第一范式(1NF)</p>
<ul>
<li>每一个分量必须是不可分的数据项</li>
</ul>
</li>
<li><p>第二范式(2NF)</p>
<ul>
<li>若R∈1NF，且每一个非主属性<strong>完全函数依赖</strong>于码，则R∈2NF</li>
<li><strong>投影分解法</strong></li>
</ul>
</li>
<li><p>第三范式(3NF)</p>
<ul>
<li>若R∈3NF，则每一个非主属性既<strong>不部分依赖</strong>于码也<strong>不传递依赖</strong>于码</li>
</ul>
</li>
<li><p>BC范式(BCNF)</p>
<ul>
<li><p>每一个决定属性因素都包含码</p>
</li>
<li><p>所有非主属性对每一个码都是完全函数依赖</p>
<p>所有的主属性对每一个不包含它的码，也是完全函数依赖</p>
<p>没有任何属性完全函数依赖于非码的任何一组属性</p>
</li>
</ul>
</li>
</ul>
<h1 id="七-数据库设计！！！"><a href="#七-数据库设计！！！" class="headerlink" title="七 数据库设计！！！"></a>七 数据库设计！！！</h1><h3 id="基本步骤"><a href="#基本步骤" class="headerlink" title="基本步骤"></a>基本步骤</h3><ol>
<li><strong>需求分析</strong><ul>
<li>准确了解与分析用户需求（包括数据与处理）</li>
</ul>
</li>
<li><strong>概念结构设计</strong><ul>
<li>通过对用户需求进行综合、归纳与抽象，形成一个独立于具体DBMS的概念模型</li>
</ul>
</li>
<li><strong>逻辑结构设计</strong><ul>
<li>将概念结构转换为某个DBMS所支持的数据模型</li>
</ul>
</li>
<li><strong>物理结构设计</strong><ul>
<li>为数据模型选取一个最适合应用环境的物理结构（包括存储结构和存取方法）</li>
</ul>
</li>
<li><strong>数据库实施</strong><ul>
<li>运用DBMS提供的数据库语言及宿主语言根据逻辑设计和物理设计的结果 建立数据库；编制与调试应用程序；组织数据入库；进行试运行</li>
</ul>
</li>
<li><strong>数据库运行和维护</strong><ul>
<li>数据库应用系统经过试运行后即可投入正式运行</li>
<li>在数据库系统运行过程中必须不断地对其进行评价、调整与修改</li>
</ul>
</li>
</ol>
<h3 id="需求分析"><a href="#需求分析" class="headerlink" title="需求分析"></a>需求分析</h3><p><strong>数据字典！</strong></p>
<ul>
<li>用途：进行详细的数据收集和数据分析所获得的主要结果</li>
<li>内容<ul>
<li>数据项：不可再分的数据单位</li>
<li>数据结构：反映了数据之间的组合关系</li>
<li>数据流：数据结构在系统内传输的路径</li>
<li>数据存储：数据结构停留或保存的地方，也是数据流的来源和去向之一</li>
<li>处理过程：具体处理逻辑一般用判定表或判定树来描述</li>
</ul>
</li>
<li>数据字典是关于数据库中数据的描述，是元数据，而不是数据本身</li>
</ul>
<h3 id="概念结构设计！！！"><a href="#概念结构设计！！！" class="headerlink" title="概念结构设计！！！"></a>概念结构设计！！！</h3><ul>
<li>步骤<ul>
<li>抽象数据并设计局部视图 （常用抽象：分类 | 聚集 | 概括）</li>
<li>集成局部视图，得到全局概念结构</li>
<li>验证整体概念结构</li>
</ul>
</li>
<li>设计局部视图<ul>
<li>选择局部应用</li>
<li>逐一设计分E-R图<ul>
<li>标定局部应用中的实体、属性、码，实体间的联系（1:1 | 1:n | m:n）</li>
<li>用E-R图描述出来</li>
</ul>
</li>
</ul>
</li>
<li>集成局部视图<ul>
<li>合并分E-R图，生成初步E-R图（冲突：属性 | 命名 | 结构）</li>
<li>修改与重构（消除不必要的冗余，设计生成基本E-R图）</li>
</ul>
</li>
</ul>
<p><strong>E-R图：实体型用矩形，属性用椭圆形，联系用菱形</strong></p>
<p><strong>属性不能再具有描述的性质，不能与其他实体具有联系。</strong></p>
<h3 id="逻辑结构设计"><a href="#逻辑结构设计" class="headerlink" title="逻辑结构设计"></a>逻辑结构设计</h3><p>把概念结构设计阶段设计好的基本E-R图转换为与选用DBMS产品所支持的数据模型相符合的逻辑结构。</p>
<ul>
<li>步骤：<ul>
<li>将概念结构转化为一般的关系、网状、层次模型</li>
<li>将转换来的关系、网状、层次模型向特定DBMS支持下的数据模型转换</li>
<li>对数据模型进行优化</li>
</ul>
</li>
<li>E-R图向关系模型的转换</li>
<li>数据模型的优化<ul>
<li>确定数据依赖</li>
<li>消除 冗余的联系</li>
<li>确定所属范式</li>
<li>分析对于这样的应用环境这些模式是否合适，确定是否进行合并或分解</li>
<li>对关系模式进行必要的分解（水瓶分解 | 垂直分解）</li>
</ul>
</li>
<li>设计用户子模式<ul>
<li>使用更符合用户习惯的别名</li>
<li>针对不同级别的用户定义不同的外模式，以满足系统对安全性的要求。</li>
<li>简化用户对系统的使用</li>
</ul>
</li>
</ul>
<h1 id="十-数据库恢复技术！！！"><a href="#十-数据库恢复技术！！！" class="headerlink" title="十 数据库恢复技术！！！"></a>十 数据库恢复技术！！！</h1><h2 id="事务的基本概念！！！"><a href="#事务的基本概念！！！" class="headerlink" title="事务的基本概念！！！"></a>事务的基本概念！！！</h2><ul>
<li>定义<ul>
<li>用户定义的一个<strong>数据库操作序列</strong>，这些操作要么全做要么全不做，是一个不可分割的单位。</li>
</ul>
</li>
<li>事务和程序<ul>
<li>在关系数据库中，一个事务可以是一条或多条SQL语句,也可以包含一个或多个程序。一个程序通常包含多个事务。</li>
</ul>
</li>
<li><code>BEGIN TRANSACTION</code>、<code>COMMIT</code>、<code>ROLLBACK</code></li>
<li>ACID特性<ul>
<li><strong>原子性</strong>、<strong>一致性</strong>、<strong>隔离性</strong>、<strong>持续性</strong></li>
</ul>
</li>
</ul>
<h2 id="故障的种类"><a href="#故障的种类" class="headerlink" title="故障的种类"></a>故障的种类</h2><ul>
<li>事务内部的故障<ul>
<li>有的是可以通过事务程序本身发现的</li>
<li>有的是非预期的：运算溢出，并发事务发生死锁而被选中撤销该事务，违反了某些完整性限制等</li>
<li>恢复：撤消事务（UNDO）</li>
</ul>
</li>
<li>系统故障（软故障）<ul>
<li>指造成系统停止运转的任何事件，使得系统要重新启动。<ul>
<li>整个系统的正常运行突然被破坏</li>
<li>所有正在运行的事务都非正常终止</li>
<li>不破坏数据库</li>
<li>内存中数据库缓冲区的信息全部丢失</li>
</ul>
</li>
<li>常见原因<ul>
<li>特定类型的硬件错误（如CPU故障）</li>
<li>操作系统故障</li>
<li>DBMS代码错误</li>
<li>系统断电</li>
</ul>
</li>
<li>恢复<ul>
<li>强行撤消（UNDO）所有未完成事务</li>
<li>重做（REDO）所有已提交的事务</li>
</ul>
</li>
</ul>
</li>
<li>介质故障（硬故障）<ul>
<li>磁盘损坏、磁头碰撞、操作系统的某种潜在错误、瞬时强磁场干扰</li>
<li>恢复<ul>
<li>装入数据库发生介质故障前某个时刻的数据副本</li>
<li>重做自此时始的所有成功事务，将这些事务已提交的结果重新记入数据库</li>
</ul>
</li>
</ul>
</li>
<li>计算机病毒</li>
</ul>
<h2 id="恢复的实现技术"><a href="#恢复的实现技术" class="headerlink" title="恢复的实现技术"></a>恢复的实现技术</h2><p>原理：利用存储在系统其它地方的冗余数据来重建数据库中已被破坏或不正确的那部分数据</p>
<ul>
<li>如何建立冗余数据<ul>
<li>数据转储（backup）</li>
<li>登录日志文件（logging）</li>
</ul>
</li>
<li>数据转储<ul>
<li>定义：指DBA将整个数据库复制到磁带或另一个磁盘上保存起来的过程，备用的数据称为后备副本或后援副本</li>
<li>静态转储与动态转储</li>
<li>海量转储与增量转储</li>
</ul>
</li>
<li>日志文件<ul>
<li>定义：是用来记录事务对数据库的更新操作的文件</li>
<li>格式：以 记录 / 数据块 为单位</li>
<li>记录 内容：事务标识、操作类型、操作对象、更新前数据的旧值、更新后数据的新值</li>
<li>数据块 内容：事务标识、被更新的数据块</li>
<li>作用：进行事务故障恢复、系统故障恢复、协助后备副本进行介质故障恢复</li>
<li>登记日志文件必须<strong>先写日志文件，后写数据库</strong></li>
</ul>
</li>
</ul>
<h2 id="恢复策略！！！"><a href="#恢复策略！！！" class="headerlink" title="恢复策略！！！"></a>恢复策略！！！</h2><ol>
<li><strong>事务故障的恢复</strong><ul>
<li>方法：由恢复子系统利用日志文件撤消（UNDO）此事务对数据库进行的修改</li>
<li>步骤：<ol>
<li>反向扫描文件日志，查找该事务的更新操作</li>
<li>对该事务的更新操作执行逆操作</li>
<li>继续反向扫描日志文件，查找该事务的其他更新操作，并做同样处理</li>
<li>如此处理下去，直至读到此事务的开始标记，事务故障恢复完成</li>
</ol>
</li>
</ul>
</li>
<li><strong>系统故障的恢复</strong><ul>
<li>方法：UNDO、REDO</li>
<li>步骤：<ol>
<li>正向扫描日志文件</li>
<li>对撤销(Undo)队列事务进行撤销(UNDO)处理</li>
<li>对重做(Redo)队列事务进行重做(REDO)处理</li>
</ol>
</li>
</ul>
</li>
<li><strong>介质故障的恢复</strong><ul>
<li>方法：重装数据库、重做已完成的事务</li>
<li>步骤：<ol>
<li>装入最新的后备数据库副本 ，使数据库恢复到最近一次转储时的一致性状态</li>
<li>装入有关的日志文件副本(转储结束时刻的日志文件副本) ，重做已完成的事务</li>
</ol>
</li>
<li><strong>介质故障的恢复需要DBA介入</strong>；具体的恢复操作仍由DBMS完成</li>
</ul>
</li>
</ol>
<h1 id="十一-并发控制"><a href="#十一-并发控制" class="headerlink" title="十一 并发控制"></a>十一 并发控制</h1><h2 id="并发控制概述"><a href="#并发控制概述" class="headerlink" title="并发控制概述"></a>并发控制概述</h2><ul>
<li>并发操作导致：<ul>
<li>数据不一致性：<ul>
<li>丢失修改、不可重复读、读“脏”数据</li>
</ul>
</li>
<li>破坏了事务的隔离性</li>
</ul>
</li>
<li>主要技术：有封锁、时间戳、乐观控制法、多版本并发控制法</li>
</ul>
<h2 id="封锁"><a href="#封锁" class="headerlink" title="封锁"></a>封锁</h2><ul>
<li>定义：事务T在对某个数据对象（例如表、记录等）操作之前，先向系统发出请求，对其加锁</li>
<li>基本封锁类型<ul>
<li><strong>排它锁（X锁）</strong><ul>
<li>若事务T对数据对象A加上X锁，则只允许T读取和修改A，其它任何事务都不能再对A加任何类型的锁，直到T释放A上的锁</li>
<li>保证其他事务在T释放A上的锁之前不能再读取和修改A</li>
</ul>
</li>
<li><strong>共享锁（S锁）</strong><ul>
<li>若事务T对数据对象A加上S锁，则其它事务只能再对A加S锁，而不能加X锁，直到T释放A上的S锁</li>
<li>保证其他事务可以读A，但在T释放A上的S锁之前不能对A做任何修改</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="封锁协议"><a href="#封锁协议" class="headerlink" title="封锁协议"></a>封锁协议</h2><ul>
<li>一级封锁协议<ul>
<li>事务T在修改数据R之前必须先对其加X锁，直到事务结束才释放</li>
<li>防止丢失修改并保证事务T可恢复</li>
<li>不能保证可重复读和不读“脏”数据</li>
</ul>
</li>
<li>二级封锁协议<ul>
<li>一级基础上，增加事务T在读取数据R之前必须先对其加S锁，读完即可释放S锁</li>
<li>可进一步防止读“脏”数据</li>
<li>不保证可重复读</li>
</ul>
</li>
<li>三级封锁协议<ul>
<li>二级基础上，增加事务T在读取数据R之前必须先对其加S锁，直到事务结束才释放</li>
<li>进一步防止不可重复读</li>
</ul>
</li>
</ul>
<h2 id="活锁和死锁！！！"><a href="#活锁和死锁！！！" class="headerlink" title="活锁和死锁！！！"></a>活锁和死锁！！！</h2><ul>
<li>活锁<ul>
<li>永远等待</li>
<li>避免：先来先服务</li>
</ul>
</li>
<li>死锁<ul>
<li>永远不结束</li>
<li>预防死锁：<ul>
<li>一次封锁法：一次将所有要使用的数据全部加锁；降低系统并发度，难于事先精确确定封锁对象</li>
<li>顺序封锁法：预先对数据对象规定一个封锁顺序，所有事务都按这个顺序实行封锁；维护成本，难以实现</li>
</ul>
</li>
<li>诊断与解除<ul>
<li>诊断：超时法 | 事务等待图法</li>
<li>解除：撤销一个处理死锁代价最小的事务；释放此事务持有的所有的锁</li>
</ul>
</li>
</ul>
</li>
</ul>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">PPPzzY</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://yoursite.com/2020/06/18/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/">http://yoursite.com/2020/06/18/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%AD%A6%E6%A0%A1%E8%AF%BE%E7%A8%8B/">学校课程</a><a class="post-meta__tags" href="/tags/SQL/">SQL</a></div><div class="post_share"><div class="social-share" data-image="/img/post.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> Donate<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/wechat.jpg" alt="微信"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/alipay.jpg" alt="支付寶"/><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="next-post pull-full"><a href="/2020/06/04/JS%E5%9F%BA%E7%A1%80/"><img class="next_cover lazyload" data-src="/img/post.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">JS基础</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> Recommend</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2020/04/14/数据结构——图/" title="数据结构——图"><img class="relatedPosts_cover lazyload"data-src="/img/post.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-04-14</div><div class="relatedPosts_title">数据结构——图</div></div></a></div><div class="relatedPosts_item"><a href="/2020/03/24/数据结构——树/" title="数据结构——树"><img class="relatedPosts_cover lazyload"data-src="/img/post.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-03-24</div><div class="relatedPosts_title">数据结构——树</div></div></a></div><div class="relatedPosts_item"><a href="/2020/02/07/数据结构——线性结构/" title="数据结构——线性结构"><img class="relatedPosts_cover lazyload"data-src="/img/post.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-02-07</div><div class="relatedPosts_title">数据结构——线性结构</div></div></a></div><div class="relatedPosts_item"><a href="/2020/04/08/计算机组成原理/" title="计算机组成原理"><img class="relatedPosts_cover lazyload"data-src="/img/post.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-04-08</div><div class="relatedPosts_title">计算机组成原理</div></div></a></div></div><div class="clear_both"></div></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 By PPPzzY</div><div class="framework-info"><span>Driven </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="Read Mode"></i><i class="fa fa-plus" id="font_plus" title="Increase font size"></i><i class="fa fa-minus" id="font_minus" title="Decrease font size"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="Traditional Chinese and Simplified Chinese Conversion" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="Dark Mode"></i></div><div id="rightside-config-show"><div id="rightside_config" title="Setting"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="Table of Contents" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="Back to top" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script></body></html>